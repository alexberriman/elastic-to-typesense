{
  "from": 0,
  "size": 15,
  "query": {
    "function_score": {
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "range": {
                      "activity_date_to": {
                        "gte": "now"
                      }
                    }
                  },
                  {
                    "bool": {
                      "must": {
                        "match": {
                          "activity_type_name": "Class"
                        }
                      },
                      "should": [
                        {
                          "range": {
                            "activity_date_to": {
                              "gte": "now"
                            }
                          }
                        },
                        {
                          "bool": {
                            "must_not": [
                              {
                                "exists": {
                                  "field": "activity_date_to"
                                }
                              }
                            ]
                          }
                        }
                      ]
                    }
                  }
                ]
              }
            },
            {
              "match": {
                "activity_status": "active"
              }
            },
            {
              "match": {
                "is_major_sport_event": true
              }
            },
            {
              "terms": {
                "activity_type_id": [
                  "7f9bcd80-f134-11e7-a9fc-8de6393ce2e2",
                  "7f9bcd80-f134-11e7-a9fc-8de6393ce2e3",
                  "7f9bcd80-f134-11e7-a9fc-8de6393ce2e5"
                ]
              }
            },
            {
              "terms": {
                "activity_intention": [
                  "just_have_fun",
                  "to_coach",
                  "competitive",
                  "for_fitness",
                  "skills_development",
                  "be_social",
                  "corporate",
                  "individuals",
                  "teams",
                  "families",
                  "indoor",
                  "outdoor",
                  "no_physical_contact",
                  "mild_physical_contact",
                  "high_physical_contact"
                ]
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "bool": {
                      "should": [
                        {
                          "range": {
                            "activity_age_from": {
                              "gte": 0,
                              "lte": 111
                            }
                          }
                        },
                        {
                          "range": {
                            "activity_age_to": {
                              "gte": 0,
                              "lte": 111
                            }
                          }
                        }
                      ]
                    }
                  },
                  {
                    "bool": {
                      "must": [
                        {
                          "range": {
                            "activity_age_from": {
                              "lte": 0
                            }
                          }
                        },
                        {
                          "range": {
                            "activity_age_to": {
                              "gte": 111
                            }
                          }
                        }
                      ]
                    }
                  },
                  {
                    "bool": {
                      "must": [
                        {
                          "term": {
                            "activity_age_from": 0
                          }
                        },
                        {
                          "term": {
                            "activity_age_to": 111
                          }
                        }
                      ]
                    }
                  }
                ]
              }
            },
            {
              "terms": {
                "activity_sport_type_id": [
                  "df00e135-49ed-4a2a-9cd8-91f879e2c99e",
                  "2a15fb6e-e725-4f16-91a4-b4ff096fa1bf",
                  "6bebcd3c-a9db-41fb-8d07-ef1ef61250d8",
                  "f37f9fbd-1ceb-4a8d-b472-7b08c40847f8",
                  "68b60593-546e-49c8-a706-3d0b74dd1789",
                  "cc1d7986-1882-4082-a9e9-fd0e71c61a6d",
                  "2baac755-8f42-4d84-902a-cd656b02217f",
                  "3a5366bc-67fa-4779-9794-73184277700a",
                  "f5f745f2-33a1-4c24-b31a-b6a20198286b",
                  "c35b46c4-276c-4a48-9bdb-6daa3dfc7469",
                  "95882c72-dac4-472d-8b08-68eeb04cc9e2",
                  "da16e092-3495-4394-b143-2045338ef90a",
                  "7846ccd0-b60f-409a-95a6-09f7d785465d",
                  "5e4f5a7d-7c30-47a6-ae5a-559d29f06e8a",
                  "46cd7bfd-21f4-425e-99d5-acf359dac11d",
                  "b7f8b54b-1438-4677-a9b2-9caec02b1c59",
                  "8bf65f89-bebe-4e74-8782-769889b2bf97",
                  "35335396-583b-4d7f-9e97-d1a2157139b3",
                  "b08d4566-4213-423a-9fa2-85d9f77c6d65",
                  "75cb598f-4274-4e96-abe0-31ef6a75eadf",
                  "c3687cfb-d093-402d-807e-fe9ee43e9611",
                  "672bf97a-b282-451a-acf9-90062bbab7e2",
                  "1a887a38-e15a-4ff7-aa9d-3e807bfd982b",
                  "2d6efba5-5668-4fe8-8bf0-06fc1ee01580",
                  "0fb15f9b-1923-441a-806b-84dbb9793deb",
                  "044bb232-cb06-4cac-a0e4-69ea4c139cfe",
                  "fc57620e-76b8-425b-bfb3-e352c4904c8a",
                  "a14e1efa-9acf-49db-aac1-599fd68f1991",
                  "6e26d4c6-a918-45cf-9b48-62ebb254f2f9",
                  "3d3a0309-ba58-4625-9df6-6983d8ae2462",
                  "44176c80-f7c7-4f7e-94fa-240d1252bd89",
                  "a3e6f4b6-98bc-488e-aa4d-0a73414f4274",
                  "d849625c-3767-40a6-a9e2-583378e4286e",
                  "4cd76c6b-33f3-4299-a579-c4f1ccba1a70"
                ]
              }
            },
            {
              "terms": {
                "activity_difficulties": [
                  "7f9bcd80-f134-11e7-a9fc-8de6393ce2e1",
                  "7f9bcd80-f134-11e7-a9fc-8de6393ce2e3",
                  "7f9bcd80-f134-11e7-a9fc-8de6393ce2e2",
                  "7f9bcd80-f134-11e7-a9fc-8de6393ce2e4",
                  "7f9bcd80-f134-11e7-a9fc-8de6393ce2e5"
                ]
              }
            },
            {
              "match": {
                "activity_status": "active"
              }
            },
            {
              "match": {
                "organisation_status": "active"
              }
            }
          ],
          "must_not": [
            {
              "match": {
                "activity_is_personal": true
              }
            },
            {
              "term": {
                "visibility": "invite_only"
              }
            },
            {
              "term": {
                "visibility": "private"
              }
            },
            {
              "match": {
                "activity_type_id": "7f9bcd80-f134-11e7-a9fc-8de6393ce2e1"
              }
            },
            {
              "match": {
                "activity_type_id": "7f9bcd80-f134-11e7-a9fc-8de6393ce2e8"
              }
            }
          ]
        }
      },
      "functions": [
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "a3e6f4b6-98bc-488e-aa4d-0a73414f4274"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "2d6efba5-5668-4fe8-8bf0-06fc1ee01580"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "3d3a0309-ba58-4625-9df6-6983d8ae2462"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "6e26d4c6-a918-45cf-9b48-62ebb254f2f9"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "46cd7bfd-21f4-425e-99d5-acf359dac11d"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "2baac755-8f42-4d84-902a-cd656b02217f"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "672bf97a-b282-451a-acf9-90062bbab7e2"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "68b60593-546e-49c8-a706-3d0b74dd1789"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "cc1d7986-1882-4082-a9e9-fd0e71c61a6d"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "d849625c-3767-40a6-a9e2-583378e4286e"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "5e4f5a7d-7c30-47a6-ae5a-559d29f06e8a"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "c35b46c4-276c-4a48-9bdb-6daa3dfc7469"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "7846ccd0-b60f-409a-95a6-09f7d785465d"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "44176c80-f7c7-4f7e-94fa-240d1252bd89"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "b7f8b54b-1438-4677-a9b2-9caec02b1c59"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "df00e135-49ed-4a2a-9cd8-91f879e2c99e"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "2a15fb6e-e725-4f16-91a4-b4ff096fa1bf"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "6bebcd3c-a9db-41fb-8d07-ef1ef61250d8"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "f37f9fbd-1ceb-4a8d-b472-7b08c40847f8"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "68b60593-546e-49c8-a706-3d0b74dd1789"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "cc1d7986-1882-4082-a9e9-fd0e71c61a6d"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "35335396-583b-4d7f-9e97-d1a2157139b3"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "2a15fb6e-e725-4f16-91a4-b4ff096fa1bf"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "044bb232-cb06-4cac-a0e4-69ea4c139cfe"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "75cb598f-4274-4e96-abe0-31ef6a75eadf"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "8bf65f89-bebe-4e74-8782-769889b2bf97"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "95882c72-dac4-472d-8b08-68eeb04cc9e2"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "2baac755-8f42-4d84-902a-cd656b02217f"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "3a5366bc-67fa-4779-9794-73184277700a"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "f5f745f2-33a1-4c24-b31a-b6a20198286b"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "c35b46c4-276c-4a48-9bdb-6daa3dfc7469"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "95882c72-dac4-472d-8b08-68eeb04cc9e2"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "da16e092-3495-4394-b143-2045338ef90a"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "7846ccd0-b60f-409a-95a6-09f7d785465d"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "5e4f5a7d-7c30-47a6-ae5a-559d29f06e8a"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "da16e092-3495-4394-b143-2045338ef90a"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "c3687cfb-d093-402d-807e-fe9ee43e9611"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "0fb15f9b-1923-441a-806b-84dbb9793deb"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "1a887a38-e15a-4ff7-aa9d-3e807bfd982b"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "f37f9fbd-1ceb-4a8d-b472-7b08c40847f8"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "f5f745f2-33a1-4c24-b31a-b6a20198286b"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "46cd7bfd-21f4-425e-99d5-acf359dac11d"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "b7f8b54b-1438-4677-a9b2-9caec02b1c59"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "8bf65f89-bebe-4e74-8782-769889b2bf97"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "35335396-583b-4d7f-9e97-d1a2157139b3"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "b08d4566-4213-423a-9fa2-85d9f77c6d65"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "75cb598f-4274-4e96-abe0-31ef6a75eadf"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "4cd76c6b-33f3-4299-a579-c4f1ccba1a70"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "6bebcd3c-a9db-41fb-8d07-ef1ef61250d8"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "3a5366bc-67fa-4779-9794-73184277700a"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "df00e135-49ed-4a2a-9cd8-91f879e2c99e"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "a14e1efa-9acf-49db-aac1-599fd68f1991"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "b08d4566-4213-423a-9fa2-85d9f77c6d65"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "fc57620e-76b8-425b-bfb3-e352c4904c8a"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "c3687cfb-d093-402d-807e-fe9ee43e9611"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "672bf97a-b282-451a-acf9-90062bbab7e2"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "1a887a38-e15a-4ff7-aa9d-3e807bfd982b"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "2d6efba5-5668-4fe8-8bf0-06fc1ee01580"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "0fb15f9b-1923-441a-806b-84dbb9793deb"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "044bb232-cb06-4cac-a0e4-69ea4c139cfe"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "fc57620e-76b8-425b-bfb3-e352c4904c8a"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "a14e1efa-9acf-49db-aac1-599fd68f1991"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "6e26d4c6-a918-45cf-9b48-62ebb254f2f9"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "3d3a0309-ba58-4625-9df6-6983d8ae2462"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "44176c80-f7c7-4f7e-94fa-240d1252bd89"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "a3e6f4b6-98bc-488e-aa4d-0a73414f4274"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "d849625c-3767-40a6-a9e2-583378e4286e"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "4cd76c6b-33f3-4299-a579-c4f1ccba1a70"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_sport_type_id": "a0aaaa00-0a0a-0af0-aa0d-0aa0aa000a00"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "bf5df9b9-838d-4fd5-a75f-f95be77ff6db"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "d8d17c19-ada0-4caa-a21e-be7fd48ed64e"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "17a67b3e-bd4f-4e7a-84c0-f26c22f66d36"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "b3e174a1-d928-40de-8121-27ccd03a7971"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "3088ac9c-0fee-4b98-a316-64f2f5b40c86"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "4b169aa0-089d-4ae5-902d-a93f335d1321"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "ffd55043-493f-45fd-a149-ae1f6a62560b"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "1d1c8245-84e8-44b5-93e2-17bb628fe189"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "6e9f6993-4827-443c-badb-68bac96a0f7a"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "04a8aeba-2b9d-491d-a32f-a1904d6955dd"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "5d32cd35-3880-4ddb-862d-8406fb762135"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "34c655d8-bbeb-417c-a7d9-a085cfe6e5e2"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "586f22d8-80cc-472b-b3c7-6ddb621bbb90"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "b44122f2-94da-4819-9510-c07f281b337f"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "d318f2cf-73c0-4cb0-9b62-eae6627c1864"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "7ed007bd-c553-47d3-8e87-d7fae982e2ba"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "1c6dafdf-855f-482a-acc5-27194f0d9daa"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "854b7060-d790-49c9-9832-d47af736ef13"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "6233eea0-d17b-4999-96fe-6c589b87e6aa"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "match": {
              "activity_participated_user": "162f71b8-161c-45a2-ba0d-8385b7a6eb87"
            }
          },
          "weight": 30
        },
        {
          "filter": {
            "terms": {
              "activity_organisation_id": [
                "4283d0dd-86cc-45d1-98fd-93145b90f861",
                "c7b498f1-662e-455f-a101-d9d26de6706a",
                "37c4b86f-e101-4af2-ba44-56a4e03541be",
                "9a0df01b-f75a-4e6c-8479-446b91dacff3",
                "4db172ad-46f0-450e-8f15-cf763688b052",
                "c41a8cdc-2802-4e82-9757-a1d64c28f517",
                "a0aaaa00-0a0a-0af0-aa0d-0aa0aa000a00",
                "a0aaaa00-0a0a-0af0-aa0d-0aa0aa000a00"
              ]
            }
          },
          "weight": 30
        }
      ],
      "score_mode": "sum",
      "boost_mode": "replace",
      "min_score": 0
    }
  },
  "sort": [
    {
      "_score": {
        "order": "desc"
      }
    },
    {
      "_geo_distance": {
        "activity_location": {
          "lat": -27.53738,
          "lon": 152.9311473
        },
        "order": "asc",
        "unit": "m"
      }
    }
  ],
  "track_scores": true
}
